import React, { Component } from 'react';import { View, Text, Image, KeyboardAvoidingView } from 'react-native';import {Button, Icon, Container, Header, Right, Body, Content, Left, Input, Form, Textarea, Toast} from 'native-base';import CONST from "../consts";import axios from "axios/index";import { DoubleBounce } from 'react-native-loader';import Communications from 'react-native-communications';import Modal from "react-native-modal";import {connect} from "react-redux";import {Spinner} from "../common";class NewOrder extends Component{	constructor(props){		super(props);		this.state = {			visibleModal: null,			setRateValue: 1,			order: [],			orderId: this.props.navigation.state.params.orderId,			guarantee: '',			price: '',			time: '',			notes : '',			loader: false,			showToast: false,		}	}	static navigationOptions = () => ({		drawerLabel: ()=> null,	});	componentWillMount() {		axios.post( CONST.url + 'show/order', { user_id: this.props.profile.id, order_id: this.state.orderId  }).then(response => this.setState({ order: response.data.data, key: response.data.key }))	}	setOffers(){		this.setState({ loader: true });		axios.post( CONST.url + 'store/offer',			{				user_id: this.props.profile.id,				order_id: this.state.orderId,				price: this.state.price,				time: this.state.time,				warranty_time: this.state.guarantee,				notes: this.state.notes,			}).then(response => {			this.setState({ loader: false });			this.props.navigation.navigate('finishOffer')		})	}	renderLoading(){		if (this.state.loader){			return(<Spinner />);		}		if (this.state.time === '' || this.state.price === '' ){			return (				<Button block disabled style={{marginTop: 20, marginBottom: 20, width: '100%', height: 40 ,alignSelf: 'center', borderRadius: 0, justifyContent: 'center'}} light>					<Text style={{color: '#999', fontSize: 17, textAlign: 'center' }}>ارسل العرض</Text>				</Button>			);		}		return (			<Button block style={{marginTop: 20, backgroundColor: '#eebc47', width: '100%', height: 40 ,alignSelf: 'center', borderRadius: 0, justifyContent: 'center', marginBottom: 10}} onPress={() => this.setOffers()  } primary>				<Text style={{color: '#fff', fontSize: 17, textAlign: 'center'}}>ارسل العرض</Text>			</Button>		);	}	inMainOrder(){		if(this.state.order.type === "1"){			return(				<View>					<View style={{ flexDirection: 'row', marginBottom: 10 }}>						<Text style={{ flex: 1.5, color: '#518033', textAlign: 'center', fontSize: 17, marginTop: 22  }}> صور العميل :	</Text>						<View style={{ flex: 4, flexDirection: 'row', justifyContent: 'space-between' }}>							<Image resizeMode={'center'} style={{ width: 120, height: 80, borderWidth: 2, borderColor: '#58863b', borderRadius: 10 }} source={{ uri: this.state.order.problem_image1 }}/>							<Image resizeMode={'center'} style={{ width: 120, height: 80, borderWidth: 2, borderColor: '#58863b', borderRadius: 10 }} source={{ uri: this.state.order.problem_image2 }}/>						</View>					</View>					<View style={{ marginBottom: 10 }}>						<Text style={{ flex: 1.5, color: '#518033', fontSize: 17, marginTop: 22  }}>ملاحظات العميل :	</Text>						<View style={{ flex: 4, backgroundColor: '#f7f7f9', borderWidth: 1, borderColor: '#eeeeef', textAlign: 'center', padding: 5 }}>							<Text>{ this.state.order.problem_desc }</Text>						</View>					</View>				</View>			)		}		if (this.state.order.type === "4"){			return(				<View style={{ flexDirection: 'row', marginBottom: 10 }}>					<Text style={{ flex: 1.5, color: '#518033', textAlign: 'center', fontSize: 17  }}>شرائح البيانات :</Text>					<Input value={JSON.stringify(this.state.order.card_data)} style={{ backgroundColor: '#f7f7f9', borderWidth: 1, borderColor: '#eeeeef', textAlign: 'center', height: 35, flex: 4 }}/>				</View>			);		}		return <View />;	}	render(){		return(			<Container>				<Header style={{ height: 70, backgroundColor: '#437c1a', paddingTop: 15 }}>					<Right style={{ flex: 0 }}>						<Button transparent onPress={() => this.props.navigation.openDrawer()}>							<Icon name='menu' type='Entypo' style={{ color: '#fff', fontSize: 30, marginTop: 8, left: -10 }} />						</Button>					</Right>					<Body style={{ width: '100%', alignItems: 'center', alignSelf: 'center' }}>					<Text style={{ color: '#fff', textAlign: 'center', marginRight: 20, fontSize: 18 }}>طلب جديد</Text>					</Body>					<Left style={{ flex: 0 }}>						<Button transparent onPress={() => this.props.navigation.navigate('newOrders')}>							<Icon name={'ios-arrow-back'} type='Ionicons' style={{ color: '#fff' }} />						</Button>					</Left>				</Header>				<Content>					<View style={{ paddingHorizontal: 10 }}>						<View>							<Form style={{ marginTop: 10 }}>								<View style={{ flexDirection: 'row', marginBottom: 10 }}>									<Text style={{ flex: 1.5, color: '#518033', textAlign: 'center', fontSize: 17  }}>الهاتف :</Text>									<Input disabled onChangeText={(name) => this.setState({name})} value={this.state.order.user_phone} style={{ backgroundColor: '#f7f7f9', borderWidth: 1, borderColor: '#eeeeef', textAlign: 'center', height: 35, flex: 4 }}/>								</View>								<View style={{ flexDirection: 'row', marginBottom: 10 }} >									<Text style={{ flex: 1.5, color: '#518033', textAlign: 'center', fontSize: 17  }}>الموديل :</Text>									<Input disabled onChangeText={(city) => this.setState({city})} value={this.state.order.model} style={{ backgroundColor: '#f7f7f9', borderWidth: 1, borderColor: '#eeeeef', textAlign: 'center', height: 35, flex: 4 }}/>								</View>								{/*<View style={{ flexDirection: 'row', marginBottom: 10 }}>*/}									{/*<Text style={{ flex: 1.5, color: '#518033', textAlign: 'center', fontSize: 17  }}>اللون :</Text>*/}									{/*<Input onChangeText={(phone) => this.setState({phone})} value={this.state.phone} style={{ backgroundColor: '#f7f7f9', borderWidth: 1, borderColor: '#eeeeef', textAlign: 'center', height: 35, flex: 4 }}/>*/}								{/*</View>*/}								<View style={{ flexDirection: 'row', marginBottom: 10 }}>									<Text style={{ flex: 1.5, color: '#518033', textAlign: 'center', fontSize: 17  }}>العنوان :</Text>									<Input disabled onChangeText={(email) => this.setState({email})} value={this.state.order.city} style={{ backgroundColor: '#f7f7f9', borderWidth: 1, borderColor: '#eeeeef', textAlign: 'center', height: 35, flex: 4 }}/>								</View>								<View style={{ flexDirection: 'row', marginBottom: 10 }}>									<Text style={{ flex: 1.5, color: '#518033', textAlign: 'center', fontSize: 17  }}>المطلوب :</Text>									<Input disabled  value={this.state.order.type_text} style={{ backgroundColor: '#f7f7f9', borderWidth: 1, borderColor: '#eeeeef', textAlign: 'center', height: 35, flex: 4 }}/>								</View>								<View style={{ flexDirection: 'row', marginBottom: 10 }}>									<Text style={{ flex: 1.5, color: '#518033', textAlign: 'center', fontSize: 17  }}>النوع :</Text>									<Input value={this.state.order.company} style={{ backgroundColor: '#f7f7f9', borderWidth: 1, borderColor: '#eeeeef', textAlign: 'center', height: 35, flex: 4 }}/>								</View>								<View style={{ flexDirection: 'row', marginBottom: 10 }}>									<Text style={{ flex: 1.5, color: '#518033', textAlign: 'center', fontSize: 17  }}>المسافة :</Text>									<Input value={JSON.stringify(this.state.order.distance)} style={{ backgroundColor: '#f7f7f9', borderWidth: 1, borderColor: '#eeeeef', textAlign: 'center', height: 35, flex: 4 }}/>								</View>								{ this.inMainOrder() }								<KeyboardAvoidingView behavior="padding">									<View style={{ marginBottom: 10 }}>										<Text style={{ flex: 1.5, color: '#518033', fontSize: 17, marginTop: 22  }}>ادخل عرضك :	</Text>										<View>											<Input placeholder='السعر' keyboardType='number-pad' onChangeText={(price) => this.setState({price})} style={{ backgroundColor: '#f7f7f9', borderWidth: 1, borderColor: '#eeeeef', textAlign: 'center', height: 35, flex: 4, marginBottom: 5 }}/>											<Input placeholder='مده التنفيذ' keyboardType='number-pad' onChangeText={(time) => this.setState({time})} style={{ backgroundColor: '#f7f7f9', borderWidth: 1, borderColor: '#eeeeef', textAlign: 'center', height: 35, flex: 4 , marginBottom: 5}}/>											<Input placeholder='فتره الضمان' keyboardType='number-pad' onChangeText={(guarantee) => this.setState({guarantee})} style={{ backgroundColor: '#f7f7f9', borderWidth: 1, borderColor: '#eeeeef', textAlign: 'center', height: 35, flex: 4, marginBottom: 5 }}/>											<Textarea onChangeText={(notes) => this.setState({ notes })} rowSpan={5} placeholderTextColor={{ color: '#d4d4d4' }} style={{ backgroundColor: '#f4f4f4', borderColor: '#ededed', borderWidth: 1, borderRadius: 5 }} bordered placeholder="ملاحظات ..." />										</View>									</View>								</KeyboardAvoidingView>							</Form>							<View style={{ padding: 10 }}>								{ this.renderLoading() }							</View>						</View>					</View>				</Content>			</Container>		)	}}const mapStateToProps = ({ profile }) => {	return {		profile: profile.user	};};export default connect(mapStateToProps)(NewOrder);