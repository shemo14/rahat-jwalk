import React, { Component } from 'react';import { View, Text, KeyboardAvoidingView } from 'react-native';import {Button, Icon, Container, Header, Right, Body, Content, Left, Input, Form, Toast} from 'native-base';import CONST from "../consts";import axios from "axios/index";import {connect} from "react-redux";import {Spinner} from "../common";class Commission extends Component{	constructor(props){		super(props);		this.state = {			visibleModal: null,			setRateValue: 1,			accountNum: '',			accountName: '',			bankName: '',			bankingData: [],			commession: 0,			loader: false,			showToast: false,		}	}	static navigationOptions = () => ({		drawerLabel: 'تسديد العمولة' ,		drawerIcon: ( <Icon style={{ fontSize: 20, color: '#437c1a' }} type={'FontAwesome'} name={'money'}/> )	});	componentWillMount() {		axios.post( CONST.url + 'show/bank/account', { user_id: this.props.profile.id }).then(response => {			this.setState({ bankingData: response.data.data.bank_account, key: response.data.key, commession: JSON.stringify(response.data.data.commession) })		})	}	setCommission(){		this.setState({ loader: true });		axios.post( CONST.url + 'payment/commission', { user_id: this.props.profile.id, name: this.state.accountName, bank_name: this.state.bankName, account_num: this.state.accountNum }).then(response => {			this.setState({ loader: false });			Toast.show({				text: response.data.massage,				type: "success",				duration: 3000			});			this.componentWillMount()		})	}	renderLoading(){		if (this.state.loader){			return(<Spinner />);		}		if (this.state.accountNum === '' || this.state.accountName === '' || this.state.bankName === ''){			return (				<Button block disabled style={{marginTop: 20, marginBottom: 20, width: '100%', height: 40 ,alignSelf: 'center', borderRadius: 0, justifyContent: 'center'}} light>					<Text style={{color: '#999', fontSize: 17, textAlign: 'center' }}>تسديد العمولة</Text>				</Button>			);		}		return (			<Button block style={{marginTop: 20, backgroundColor: '#eebc47', width: '100%', height: 40 ,alignSelf: 'center', borderRadius: 0, justifyContent: 'center', marginBottom: 30}} onPress={() => this.setCommission()  } primary>				<Text style={{color: '#fff', fontSize: 17, textAlign: 'center'}}>تسديد العمولة</Text>			</Button>		);	}	render(){		return(			<Container>				<Header style={{ height: 70, backgroundColor: '#437c1a', paddingTop: 15 }}>					<Right style={{ flex: 0 }}>						<Button transparent onPress={() => this.props.navigation.openDrawer()}>							<Icon name='menu' style={{ color: '#fff', fontSize: 30, marginTop: 8, left: -10 }} />						</Button>					</Right>					<Body style={{ width: '100%', alignItems: 'center', alignSelf: 'center' }}>					<Text style={{ color: '#fff', textAlign: 'center', marginRight: 20, fontSize: 18 }}>تسديد العمولة</Text>					</Body>					<Left style={{ flex: 0 }}>						<Button transparent onPress={() => this.props.navigation.goBack()}>							<Icon name={'ios-arrow-back'} type='Ionicons' style={{ color: '#fff' }} />						</Button>					</Left>				</Header>				<Content>					<View style={{ paddingHorizontal: 10 }}>						<View>							<View style={{ flex: 1, marginVertical: 20, backgroundColor: '#f7f7f9', borderWidth: 1, borderColor: '#e7e7e7' }}>								<View style={{ borderRightWidth: 1, borderRightColor: '#c8c8c9', flexDirection: 'row', justifyContent: 'space-between' }}>									<View style={{ height: 50, borderBottomWidth: 1, borderBottomColor: '#c8c8c9', justifyContent: 'center', flex: 1, borderRightColor: '#c8c8c9', borderRightWidth: 1 }}>										<Text style={{ textAlign: 'center', color: '#5c8a41', fontSize: 18 }}>اسم البنك</Text>									</View>									<View style={{ height: 50, borderBottomWidth: 1, borderBottomColor: '#c8c8c9', justifyContent: 'center', flex: 1, borderRightColor: '#c8c8c9', borderRightWidth: 1 }}>										<Text style={{ textAlign: 'center', color: '#5c8a41', fontSize: 18 }}>اسم الحساب</Text>									</View>									<View style={{ height: 50, borderBottomWidth: 1, borderBottomColor: '#c8c8c9', justifyContent: 'center', flex: 1 }}>										<Text style={{ textAlign: 'center', color: '#5c8a41', fontSize: 18 }}>رقم الحساب</Text>									</View>								</View>								{									this.state.bankingData.map((bank, i) => {										return(											<View key={i} style={{ borderRightWidth: 1, borderRightColor: '#c8c8c9', flexDirection: 'row', justifyContent: 'space-between' }}>												<View style={{ height: 50, borderBottomWidth: 1, borderBottomColor: '#c8c8c9', justifyContent: 'center', flex: 1,  borderRightColor: '#c8c8c9', borderRightWidth: 1 }}>													<Text style={{ textAlign: 'center', color: '#8f8f8f' }}>{ bank.bank_name }</Text>												</View>												<View style={{ height: 50, borderBottomWidth: 1, borderBottomColor: '#c8c8c9', justifyContent: 'center', flex: 1, borderRightColor: '#c8c8c9', borderRightWidth: 1 }}>													<Text style={{ textAlign: 'center', color: '#8f8f8f' }}>{ bank.account_name }</Text>												</View>												<View style={{ height: 50, borderBottomWidth: 1, borderBottomColor: '#c8c8c9', justifyContent: 'center', flex: 1 }}>													<Text style={{ textAlign: 'center', color: '#8f8f8f' }}>{ bank.account_num }</Text>												</View>											</View>										)									})								}							</View>							<Form style={{ marginTop: 10 }}>								<View style={{ flexDirection: 'row', marginBottom: 10 }}>									<Text style={{ flex: 2, color: '#518033', fontSize: 17  }}>المبلغ المستحق :</Text>									<Input disabled value={this.state.commession} style={{ backgroundColor: '#f7f7f9', borderWidth: 1, borderColor: '#eeeeef', textAlign: 'center', height: 35, flex: 4 }}/>								</View>								<KeyboardAvoidingView behavior="padding">									<View style={{ marginBottom: 10 }}>										<Text style={{ flex: 1.5, color: '#518033', fontSize: 17, marginTop: 22  }}>معلومات العميل :	</Text>										<View>											<Input placeholder='رقم الحساب المحول منه' onChangeText={(accountNum) => this.setState({accountNum})} style={{ backgroundColor: '#f7f7f9', borderWidth: 1, borderColor: '#eeeeef', textAlign: 'center', height: 35, flex: 4, marginBottom: 5 }}/>											<Input placeholder='اسم صاحب الحساب' onChangeText={(accountName) => this.setState({accountName})} style={{ backgroundColor: '#f7f7f9', borderWidth: 1, borderColor: '#eeeeef', textAlign: 'center', height: 35, flex: 4 , marginBottom: 5}}/>											<Input placeholder='البنك' onChangeText={(bankName) => this.setState({bankName})} style={{ backgroundColor: '#f7f7f9', borderWidth: 1, borderColor: '#eeeeef', textAlign: 'center', height: 35, flex: 4, marginBottom: 5 }}/>										</View>									</View>								</KeyboardAvoidingView>							</Form>						</View>					</View>				</Content>				<View style={{ paddingHorizontal: 10, marginBottom: 20 }}>					{ this.renderLoading() }				</View>			</Container>		)	}}const mapStateToProps = ({ profile }) => {	return {		profile: profile.user	};};export default connect(mapStateToProps)(Commission);